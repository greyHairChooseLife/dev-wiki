# 개발서버 터널링 이슈



## 무슨 이슈인가?

- 개발서버를 셋업해줘야했다.
- 개발 단계에서도 HTTPS가 필요했다.
    - 우리가 개발하려는 것은 iOS와 LiveKit 서버가 화상통화하는 것이다.
    - iOS 클라이언트에서 LiveKit 서버 또는 api 서버로 요청을 주고받을 때 HTTPS가 필요하여, 해당 서버들은
      개발단계에서도 HTTPS가 강제된다.
    - iOS 시뮬레이터를 사용할 수 없다.
    - 모든 팀원이 모바일 개발을 하는것이 아니다.



## 해결

- cloudflare tunnel을 사용한다.
    - 고정 도메인을 사용할 수 있다.
    - 무료로 여러개의 터널을 팔 수 있다.
    - 관리자가 터널을 생성하고 분배할 수 있다.
    - 비교적 안정적이라고 함


> [!nt]
>
> docker로 실행하는데 


tunnels for docker

1.sodam.store
docker run cloudflare/cloudflared:latest tunnel --no-autoupdate run --token eyJhIjoiYWUzZDkzNDYwNTczZjFkMGYxY2EwNWM4M2FmMTM0NzkiLCJ0IjoiNjZkODVkODktNzc1NS00ZGM5LTk2YjYtMzBjMTEzZmMwOGExIiwicyI6Ik9XUmhaVGd3TW1NdE5UQTJOUzAwTVdJNExUazVaamd0TXpjNE4yTmpOamhtTm1ZMiJ9

2.sodam.store
docker run cloudflare/cloudflared:latest tunnel --no-autoupdate run --token eyJhIjoiYWUzZDkzNDYwNTczZjFkMGYxY2EwNWM4M2FmMTM0NzkiLCJ0IjoiNGZjMDJhOTItYWI2MS00ODRiLWE1M2EtZTNmYzNlOWI0OWE5IiwicyI6IlpURmpPVGs1T1RJdFptSmtOeTAwTUdJNExXSXpOREF0TnpkbU1USmhNakV3T0RaaiJ9

3.sodam.store
docker run cloudflare/cloudflared:latest tunnel --no-autoupdate run --token eyJhIjoiYWUzZDkzNDYwNTczZjFkMGYxY2EwNWM4M2FmMTM0NzkiLCJ0IjoiNTgwYjgyZjUtYzNjYi00ODExLWFjMWUtZTUwYzg0N2JiODU4IiwicyI6IlpEQm1Zekl6WVdJdE1XVTJZeTAwTURCakxXRTRaakV0TnpRMk5tRmpaR0V6TWpKaCJ9

4.sodam.store
docker run cloudflare/cloudflared:latest tunnel --no-autoupdate run --token eyJhIjoiYWUzZDkzNDYwNTczZjFkMGYxY2EwNWM4M2FmMTM0NzkiLCJ0IjoiYmFhYzE2ZWEtMzcxMy00OTBlLTg1ZGEtYjFmOTlmYjIwOTU2IiwicyI6IllUWXhOVFprTlRrdE5qbGtNUzAwTVRNMkxUazFZV0l0TXpRNE1ETXlZbVpoWm1WbSJ9

5.sodam.store
docker run cloudflare/cloudflared:latest tunnel --no-autoupdate run --token eyJhIjoiYWUzZDkzNDYwNTczZjFkMGYxY2EwNWM4M2FmMTM0NzkiLCJ0IjoiY2QzZWU1YjAtYjg5OS00OWQwLWIzZDQtNjA4NGUwM2FkMDcwIiwicyI6Ik5tTXhNMk13T0RrdE4yRTROQzAwTVRrM0xUazVaalV0WlRrME5ERTNabUZqWXpSayJ9



## 실패


- 터널이 잘 뚫리고 ddns처럼 domain으로부터 나의 localhost로 잘 접속되었다.
    - 그래서 성공인줄 알았는데 실패했다.
    - 쒯...

- livekit 서버는 영상통화(webRTC) 통신을 위해 UDP 프로토콜을 사용한다.
- 근데 cloudflare tunnel은 이 프로토콜을 지원하지 않는다.
- 우회 방법이 있다지만 그냥 시간을 돈으로 사는게 좋을듯.
